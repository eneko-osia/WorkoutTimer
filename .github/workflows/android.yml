name: android

on:
    push:
        branches:
            - 'master'
            - 'develop'
        paths-ignore:
            - '**.md'
    pull_request:
        branches:
            - 'master'
            - 'develop'
        paths-ignore:
            - '**.md'

jobs:
    build:
        name: Build Android
        runs-on: ${{matrix.os}}
        strategy:
            matrix:
                os: [ ubuntu-latest ]
                build_type: [ assembleDebug ]

        steps:
        - name: Checkout repository
          uses: actions/checkout@v4

        - name: Set up Java
          uses: actions/setup-java@v3
          with:
            distribution: 'temurin'
            java-version: '17'

        - name: Set up Node
          uses: actions/setup-node@v3
          with:
            node-version: '18'

        - name: Install dependencies
          run: npm install

        # - name: Run Lint (optional)
        #   run: npm run lint

        - name: Cache Gradle
          uses: actions/cache@v3
          with:
            path: |
                ~/.gradle/caches
                ~/.gradle/wrapper
            key: ${{ runner.os }}-gradle-${{ hashFiles('**/*.gradle*', '**/gradle-wrapper.properties') }}
            restore-keys: |
                ${{ runner.os }}-gradle-

        - name: Build
          working-directory: android
          run: ./gradlew ${{matrix.build_type}}

        # - name: Upload debug APK
        #   uses: actions/upload-artifact@v3
        #   with:
        #     name: WorkoutTimer-debug-apk
        #     path: android/app/build/outputs/apk/debug/WorkoutTimer-debug.apk
